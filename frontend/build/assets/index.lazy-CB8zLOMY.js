import{y as ie,R as B,j as e,E as H,D as ce,a as de,B as N,b as ue,c as P,e as A,d as me,G as ge,H as b,C as V,I as z,J as xe,K as O,s as g,L as pe,N as he,O as fe,P as D,Q as be,T as je,U as L,V as ve,z as f,u as ye,t as Se,W as Ce,X as we,Y as Ne,Z as Te,_ as _e,F as De,k as v,l as y,m as S,n as C,o as w,$ as K,a0 as Le,a1 as Fe,v as Ie,M as Re,a2 as Me,a3 as ke,w as Ee,x as Pe}from"./index-D6FmMTvM.js";import{D as Ae,I as Ve,a as G,C as Ke,b as Ge,u as $e,c as Be,s as He,d as ze,g as Oe,e as qe,f as Ye}from"./use-dialog-state-BStcso-z.js";import{L as Qe,I as q}from"./long-text-DbX7zpkV.js";import{L as Je,C as Ue}from"./confirm-dialog-BqHcj-me.js";/**
 * @license @tabler/icons-react v3.26.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var We=ie("outline","download","IconDownload",[["path",{d:"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2",key:"svg-0"}],["path",{d:"M7 11l5 5l5 -5",key:"svg-1"}],["path",{d:"M12 4l0 12",key:"svg-2"}]]);const Y=B.createContext(null);function Xe({children:s,value:t}){return e.jsx(Y.Provider,{value:t,children:s})}const Ze=()=>{const s=B.useContext(Y);if(!s)throw new Error("useSslManagerContext has to be used within <SslManagerListContextProvider.Provider>");return s};function es({row:s}){const{toast:t}=H(),{setOpen:a,setCurrentRow:o}=Ze(),l=i=>{ge(i).then(n=>n.data).then(({error:n,data:x})=>{n?t({title:"Error",description:n==null?void 0:n.message,variant:"destructive"}):window.open(`/download.php?id=${x.id}`,"_blank")}).catch(n=>{t({title:"Error",description:n==null?void 0:n.message,variant:"destructive"})})};return e.jsxs(ce,{modal:!1,children:[e.jsx(de,{asChild:!0,children:e.jsxs(N,{variant:"ghost",className:"flex text-right h-8 w-8 p-0 data-[state=open]:bg-muted",children:[e.jsx(Ae,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Open menu"})]})}),e.jsxs(ue,{align:"end",className:"w-[160px]",children:[e.jsxs(P,{onClick:()=>l(s.original.id),children:["Download",e.jsx(A,{children:e.jsx(We,{size:16})})]}),e.jsx(me,{}),e.jsxs(P,{onClick:()=>{o(s.original),a("delete")},children:["Delete",e.jsx(A,{children:e.jsx(Ve,{size:16})})]})]})]})}const ss=[{value:"auto",label:"Auto Generate"},{value:"Let's Encrypt",label:"Les's Encrypt"},{value:"custom",label:"Custom SSL"}],ts=[{id:"select",meta:{className:b("sticky md:table-cell left-0 z-10 rounded-tl","bg-background transition-colors duration-200 group-hover/row:bg-muted group-data-[state=selected]/row:bg-muted")},header:({table:s})=>e.jsx(V,{checked:s.getIsAllPageRowsSelected()||s.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:t=>s.toggleAllPageRowsSelected(!!t),"aria-label":"Select all",className:"translate-y-[2px]"}),cell:({row:s})=>e.jsx(V,{checked:s.getIsSelected(),onCheckedChange:t=>s.toggleSelected(!!t),"aria-label":"Select row",className:"translate-y-[2px]"}),enableSorting:!1,enableHiding:!1},{accessorKey:"name",enableSorting:!1,header:({column:s})=>e.jsx(G,{column:s,title:"Name"}),meta:{className:b("drop-shadow-[0_1px_2px_rgb(0_0_0_/_0.1)] dark:drop-shadow-[0_1px_2px_rgb(255_255_255_/_0.1)] lg:drop-shadow-none","bg-background transition-colors duration-200 group-hover/row:bg-muted group-data-[state=selected]/row:bg-muted","sticky left-6 md:table-cell")},enableHiding:!1,cell:({row:s})=>e.jsx(Qe,{children:s.original.name??"-"})},{accessorKey:"type",header:({column:s})=>e.jsx(G,{column:s,title:"Ssl Type"}),cell:({row:s})=>{const t=ss.find(a=>a.value===s.getValue("type"));return t?e.jsx("div",{className:"flex w-[150px] items-center",children:e.jsx("span",{children:t.label})}):null},filterFn:(s,t,a)=>a.includes(s.getValue(t))},{id:"actions",cell:({row:s})=>e.jsx(es,{row:s})}];function as({table:s}){var a;const t=s.getState().columnFilters.length>0;return e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{className:"flex flex-1 flex-col-reverse items-start gap-y-2 sm:flex-row sm:items-center sm:space-x-2",children:[e.jsx(z,{placeholder:"Filter by name...",value:((a=s.getColumn("name"))==null?void 0:a.getFilterValue())??"",onChange:o=>{var l;return(l=s.getColumn("name"))==null?void 0:l.setFilterValue(o.target.value)},className:"h-8 w-[150px] lg:w-[250px]"}),t&&e.jsxs(N,{variant:"ghost",onClick:()=>s.resetColumnFilters(),className:"h-8 px-2 lg:px-3",children:["Reset",e.jsx(Ke,{className:"ml-2 h-4 w-4"})]})]}),e.jsx(Ge,{table:s})]})}var I="Tabs",[ns,ps]=xe(I,[O]),Q=O(),[rs,R]=ns(I),J=g.forwardRef((s,t)=>{const{__scopeTabs:a,value:o,onValueChange:l,defaultValue:i,orientation:n="horizontal",dir:x,activationMode:p="automatic",...c}=s,m=pe(x),[r,d]=he({prop:o,onChange:l,defaultProp:i});return e.jsx(rs,{scope:a,baseId:fe(),value:r,onValueChange:d,orientation:n,dir:m,activationMode:p,children:e.jsx(D.div,{dir:m,"data-orientation":n,...c,ref:t})})});J.displayName=I;var U="TabsList",W=g.forwardRef((s,t)=>{const{__scopeTabs:a,loop:o=!0,...l}=s,i=R(U,a),n=Q(a);return e.jsx(be,{asChild:!0,...n,orientation:i.orientation,dir:i.dir,loop:o,children:e.jsx(D.div,{role:"tablist","aria-orientation":i.orientation,...l,ref:t})})});W.displayName=U;var X="TabsTrigger",Z=g.forwardRef((s,t)=>{const{__scopeTabs:a,value:o,disabled:l=!1,...i}=s,n=R(X,a),x=Q(a),p=te(n.baseId,o),c=ae(n.baseId,o),m=o===n.value;return e.jsx(je,{asChild:!0,...x,focusable:!l,active:m,children:e.jsx(D.button,{type:"button",role:"tab","aria-selected":m,"aria-controls":c,"data-state":m?"active":"inactive","data-disabled":l?"":void 0,disabled:l,id:p,...i,ref:t,onMouseDown:L(s.onMouseDown,r=>{!l&&r.button===0&&r.ctrlKey===!1?n.onValueChange(o):r.preventDefault()}),onKeyDown:L(s.onKeyDown,r=>{[" ","Enter"].includes(r.key)&&n.onValueChange(o)}),onFocus:L(s.onFocus,()=>{const r=n.activationMode!=="manual";!m&&!l&&r&&n.onValueChange(o)})})})});Z.displayName=X;var ee="TabsContent",se=g.forwardRef((s,t)=>{const{__scopeTabs:a,value:o,forceMount:l,children:i,...n}=s,x=R(ee,a),p=te(x.baseId,o),c=ae(x.baseId,o),m=o===x.value,r=g.useRef(m);return g.useEffect(()=>{const d=requestAnimationFrame(()=>r.current=!1);return()=>cancelAnimationFrame(d)},[]),e.jsx(ve,{present:l||m,children:({present:d})=>e.jsx(D.div,{"data-state":m?"active":"inactive","data-orientation":x.orientation,role:"tabpanel","aria-labelledby":p,hidden:!d,id:c,tabIndex:0,...n,ref:t,style:{...s.style,animationDuration:r.current?"0s":void 0},children:d&&i})})});se.displayName=ee;function te(s,t){return`${s}-trigger-${t}`}function ae(s,t){return`${s}-content-${t}`}var os=J,ne=W,re=Z,oe=se;const ls=os,le=g.forwardRef(({className:s,...t},a)=>e.jsx(ne,{ref:a,className:b("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",s),...t}));le.displayName=ne.displayName;const T=g.forwardRef(({className:s,...t},a)=>e.jsx(re,{ref:a,className:b("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",s),...t}));T.displayName=re.displayName;const _=g.forwardRef(({className:s,...t},a)=>e.jsx(oe,{ref:a,className:b("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...t}));_.displayName=oe.displayName;const F=g.forwardRef(({className:s,...t},a)=>e.jsx("textarea",{className:b("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:a,...t}));F.displayName="Textarea";const is=f.object({ssl_type:f.string().min(1,{message:"SSL Type is required."}),name:f.string().min(1,{message:"Name is required."}),ssl_certificate:f.string(),ssl_key:f.string(),domains:f.array(f.object({label:f.string(),value:f.string()}))}).refine(s=>!(s.ssl_type==="custom"&&(!s.ssl_certificate||!s.ssl_key)),{message:"SSL Certificate is required",path:["ssl_certificate"]}).refine(s=>!(s.ssl_type==="custom"&&!s.ssl_key),{message:"SSL Key is required.",path:["ssl_key"]});function cs({open:s,onOpenChange:t,onCreated:a}){const[o,l]=g.useState("auto"),[i,n]=g.useState(!1),[x,p]=g.useState(null),c=ye({resolver:Se(is),defaultValues:{ssl_type:"auto",domains:[],name:"",ssl_certificate:"",ssl_key:""}}),m=r=>{n(!0),Fe(r).then(d=>d.data).then(({error:d,data:j})=>{d?(d.path?c.setError(d.path,{message:d.message}):p(d.message),n(!1)):(j.id&&(c.reset(),t(!1),a&&a()),n(!1))}).catch(d=>{p((d==null?void 0:d.message)??"An error occurred"),n(!1)})};return e.jsx(Ce,{open:s,onOpenChange:r=>{c.reset(),t(r)},children:e.jsxs(we,{className:"sm:max-w-lg",children:[e.jsxs(Ne,{className:"text-left",children:[e.jsx(Te,{children:"Create new SSL Key"}),e.jsx(_e,{children:x&&e.jsx("p",{className:"text-red-500",children:x})})]}),e.jsx(De,{...c,children:e.jsxs("form",{id:"ssl-form",onSubmit:c.handleSubmit(m),className:"space-y-2 p-0.5",children:[e.jsx(v,{control:c.control,name:"name",render:({field:r})=>e.jsxs(y,{children:[e.jsx(S,{className:"col-span-2 text-right",children:"SSL Name"}),e.jsx(C,{children:e.jsx(z,{placeholder:"Enter SSL Name",...r})}),e.jsx(w,{className:"col-span-4 col-start-3"})]})}),e.jsxs(ls,{onValueChange:r=>{c.setValue("ssl_type",r),l(r)},defaultValue:"auto",className:"text-center",children:[e.jsxs(le,{className:"grid w-full grid-cols-3",children:[e.jsx(T,{value:"auto",children:"Auto Generator"}),e.jsx(T,{value:"le",children:"Let's Encrypt"}),e.jsx(T,{value:"custom",children:"Custom"})]}),e.jsxs(_,{value:"auto",className:"text-left",children:[e.jsx("br",{}),e.jsx(v,{control:c.control,name:"domains",render:({field:r})=>e.jsxs(y,{children:[e.jsx(S,{className:"col-span-2 text-right",children:"Domain Names"}),e.jsx(C,{children:e.jsx(K,{isMulti:!0,placeholder:"Enter Domain Names",...r})}),e.jsx(w,{className:"col-span-4 col-start-3"})]})}),e.jsx("br",{}),e.jsx(N,{className:"pt-2",type:"submit",form:"ssl-form",disabled:i,children:"Generate Now"})]}),e.jsx(_,{value:"le",className:"text-left",children:e.jsx(v,{control:c.control,name:"domains",render:({field:r})=>e.jsxs(y,{children:[e.jsx(S,{className:"col-span-2 text-right",children:"Domain Names"}),e.jsx(C,{children:e.jsx(K,{isMulti:!0,placeholder:"Enter Domain Names",...r})}),e.jsx(w,{className:"col-span-4 col-start-3"})]})})}),e.jsxs(_,{value:"custom",className:"text-left",children:[e.jsx(v,{control:c.control,name:"ssl_certificate",render:({field:r})=>e.jsxs(y,{children:[e.jsx(S,{className:"col-span-2 text-right",children:"SSL Certificate"}),e.jsx(C,{children:e.jsx(F,{style:{minHeight:"100px"},placeholder:"-----BEGIN CERTIFICATE-----",...r})}),e.jsx(w,{className:"col-span-4 col-start-3"})]})}),e.jsx(v,{control:c.control,name:"ssl_key",render:({field:r})=>e.jsxs(y,{children:[e.jsx(S,{className:"col-span-2 text-right",children:"SSL Key"}),e.jsx(C,{children:e.jsx(F,{style:{minHeight:"100px"},placeholder:"-----BEGIN PRIVATE KEY-----",...r})}),e.jsx(w,{className:"col-span-4 col-start-3"})]})})]})]})]})}),e.jsx(Le,{children:o!=="custom"?e.jsx(e.Fragment,{}):e.jsxs(N,{type:"submit",form:"ssl-form",disabled:i,children:[i&&e.jsx(Je,{className:"animate-spin"}),"Create",e.jsx(q,{})]})})]})})}const $={title:"SSL Keys List",bareadcrumb:[{name:"Home",href:"/"},{name:"SSL keys List"}]},ds=({id:s})=>{var E;const{toast:t}=H(),[a,o]=g.useState(null),[l,i]=$e(null),[n,x]=g.useState([]),{filters:p,pagination:c,setFilters:m}=Be(s),r=He(p.sortBy),{isLoading:d,error:j,data:h,refetch:M}=Ie({queryKey:["sslList",p],queryFn:()=>ke(p).then(u=>u.data),placeholderData:Ee}),k=ze({columns:ts,state:{pagination:c,sorting:r,columnFilters:n},data:(h==null?void 0:h.data)??[],manualFiltering:!0,manualSorting:!0,manualPagination:!0,onColumnFiltersChange:x,getCoreRowModel:Oe(),onPaginationChange:u=>{m(typeof u=="function"?u(c):u)},onSortingChange:u=>{m({sortBy:qe(typeof u=="function"?u(r):u)})},pageCount:(h==null?void 0:h.pageCount)??-1,rowCount:h==null?void 0:h.rowCount});return g.useEffect(()=>{console.log(n)},[n]),e.jsxs(Xe,{value:{open:l,setOpen:i,currentRow:a,setCurrentRow:o},children:[e.jsxs(Re,{loading:d,error:(j==null?void 0:j.message)??((E=h==null?void 0:h.error)==null?void 0:E.message),title:$.title,bareadcrumb:$.bareadcrumb,rightComponent:e.jsxs(N,{className:"space-x-1",onClick:()=>i("create"),children:[e.jsx(q,{size:18})," ",e.jsx("span",{children:"Create SSL"})]}),children:[e.jsx(as,{table:k}),e.jsx(Ye,{table:k})]}),e.jsx(cs,{open:l==="create",onOpenChange:()=>i("create"),onCreated:()=>M()},"sslmanager-create"),a&&e.jsx(e.Fragment,{children:e.jsx(Ue,{destructive:!0,open:l==="delete",onOpenChange:()=>{i("delete"),setTimeout(()=>{o(null)},500)},handleConfirm:()=>{Me(a.id).then(u=>u==null?void 0:u.data).then(({error:u})=>{u?t({title:"Error",description:u.message,variant:"destructive"}):(M(),i(null),t({title:"Success",description:"SSL deleted successfully",variant:"default"}))}).catch(u=>{t({title:"Error",description:u==null?void 0:u.message,variant:"destructive"})})},className:"max-w-md",title:`Delete this SSL ${a.name}?`,desc:e.jsxs(e.Fragment,{children:["You are about to delete a SSL with the ID "," ",e.jsx("strong",{children:a.id}),". ",e.jsx("br",{}),"This action cannot be undone."]}),confirmText:"Delete"},"sslmanager-delete")})]})},hs=Pe("/_authenticated/ssl-manager/")({component:ds});export{hs as Route};
